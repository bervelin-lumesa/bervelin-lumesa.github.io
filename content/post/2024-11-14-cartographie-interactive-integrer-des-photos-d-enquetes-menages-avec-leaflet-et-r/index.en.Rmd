---
title: 'Cartographie Interactive : Int√©grer des Photos d''Enqu√™tes M√©nages avec Leaflet et R'
author: 'Bervelin Lumesa'
date: '2024-11-14'
slug: cartographie-interactive-integrer-des-photos-d-enquetes-menages-avec-leaflet-et-r
categories: []
tags: [leaflet]
---

Mbote üëã 

## Introduction

Dans le domaine de la data science et de l'analyse g√©ospatiale, la capacit√© √† visualiser des donn√©es de mani√®re claire et intuitive est primordiale. Avec l'augmentation des enqu√™tes m√©nages et autres √©tudes bas√©es sur des donn√©es g√©ographiques, il devient essentiel de pr√©senter les r√©sultats de mani√®re engageante et informative. C'est l√† qu'intervient Leaflet, une biblioth√®que JavaScript puissante et flexible pour les cartes interactives.

En combinant Leaflet avec le langage de programmation R, les chercheurs et analystes peuvent non seulement cartographier des donn√©es g√©ographiques, mais aussi int√©grer des √©l√©ments multim√©dia tels que des photos. Cette int√©gration permet de contextualiser les donn√©es et de fournir des insights plus riches et plus pr√©cis.

Cet article explorera comment utiliser le package leaflet en R pour afficher des photos sur une carte interactive, en prenant l'exemple d'une enqu√™te m√©nage (donn√©es simul√©es). Nous d√©taillerons chaque √©tape du processus, de l'a pr√©paration'importation des donn√©es √† la cr√©ation de la carte, en passant par l'int√©gration des photos, pour permettre aux utilisateurs de visualiser les conditions de vie des m√©nages directement sur une carte interactive.


## Cr√©ation de la carte avec `leaflet`

### Chargement des librairies

Nous commen√ßons par charger les packages n√©cessaires :

```{r, warning=FALSE, message=FALSE}
library(leaflet)
library(base64enc)
library(dplyr)
```


### Importation de donn√©es

Nous importons notre dataframe avec des coordonn√©es GPS et des noms de photos

```{r}
df <- read.csv("df.csv")
head(df)
```


Nous indiquons le nom du dossier qui contient nos photos et stockons cela dans un objet.

```{r}
dossier_images = 'images'
```


### Cr√©ation d'une colonne pour les images encod√©es en base64

Pour afficher les images en locales sur la carte, nous devons les encoder en base 64. C'est ce que fait le code suivant :

```{r}
df <- df |> 
  rowwise() |>
  mutate(photo_encoded = dataURI(file = file.path(dossier_images, photo_mild), mime = "image/png"))
```

### Premi√®re carte 

Le code suivant permet de produire une carte vide. Nous allons voir comment y ajouter des points et afficher des photos.

```{r}
(m <- leaflet(df) %>%
      addTiles())
```


### Ajout des points et affichage des photos

Pour ajouter les points et afficher les photos des moustiquaires de chaque m√©nage sur la carte pr√©c√©dente, nous utilisons une boucle `for()`. Gr√¢ce aux arguments lng, lat et popup, nous pr√©cisons la longitude, la latitude et la photo de la moustiquaire. Noter que nous nous sommes servis des tags HTML pour formater l'affichage. 

NB: Pour des cartes comportant plusieurs photos, le processus de g√©n√©ration de la carte peut √™tre longue.

```{r}
# Ajouter les marqueurs avec les photos dans les pop-ups.
for (i in 1:nrow(df)) {
  m <- m %>%
    addMarkers(
      lng = df$longitude[i],
      lat = df$latitude[i],
      popup = paste0("<table>",
                         "<tr>",
                         "<td>Nom du chef de m√©nage</td>",
                         paste("<td>:", df$nom_chef[i], "</td>"),
                         "</tr>",
                     "</table>",
                     "<img src='", df$photo_encoded[i], "' width='200' height='150'>")
    )
}
m
```

Voila! Le r√©sultat est une carte int√©ractive avec les points repr√©santant les coordonn√©es de chaque m√©nage. En cliquant sur chaque point, nous affichons la photo de la moustique que l'enqu√™teur a photographi√© lors de la collecte de donn√©es sur terrain.


## Conclusion

L'int√©gration des donn√©es photos sur des cartes interactives √† l'aide de Leaflet et R offre un puissant outil de visualisation et d'analyse, particuli√®rement utile dans le cadre des enqu√™tes m√©nages. Cette approche permet non seulement de cartographier des donn√©es g√©ographiques, mais √©galement de contextualiser les r√©sultats avec des √©l√©ments visuels, enrichissant ainsi l'interpr√©tation des donn√©es et facilitant la communication des r√©sultats aux parties prenantes.

L'utilisation de Leaflet pour afficher des photos sur une carte interactive rend les donn√©es plus accessibles et engageantes. Cela permet aux chercheurs, aux d√©cideurs et au grand public de mieux comprendre les conditions de vie des m√©nages enqu√™t√©s et de prendre des d√©cisions inform√©es bas√©es sur une visualisation g√©ospatiale enrichie.

En appliquant les techniques pr√©sent√©es dans cet article, vous serez en mesure de cr√©er des cartes interactives int√©grant des photos, offrant ainsi une perspective visuelle pr√©cieuse pour vos analyses et pr√©sentations de donn√©es. Cette m√©thodologie peut √™tre √©tendue √† d'autres types d'enqu√™tes et de projets, d√©montrant ainsi la polyvalence et la puissance des outils de visualisation g√©ospatiale combin√©s avec R.

Tous les codes peuvent √™tre trouv√©s ici dans mon [Github](https://github.com/bervelin-lumesa/r-blog-articles/tree/main/carte_leaflet_avec_photo)  


## Avez-vous trouv√© cet article utile ? Pensez √† le partager üôå